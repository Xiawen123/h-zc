<!DOCTYPE HTML>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.w3.org/1999/xhtml">
<meta charset="utf-8">
<head th:include="include :: header('添加校区领用登记')"></head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-campusrecive-add">
			<div class="form-group">
				<label class="col-sm-3 control-label">领用校区：</label>
				<div class="col-sm-8">
					<input name="campus" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">领用部门：</label>
				<div class="col-sm-8">
					<select name="department" class="form-control m-b" th:with="type=${@dict.getType('zc_department')}">
						<option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
					</select>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">领用人员：</label>
				<div class="col-sm-8">
					<input name="extend2" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-3 control-label">领用时间：</label>
				<div class="col-sm-8">
					<div class="input-group date">
						<input type="date" name="recipientsTime" class="form-control">
					</div>
				</div>
			</div>
			<div class="btn-group-sm" id="toolbar" role="group">
				<a class="btn btn-success" onclick="$.operate.addFull()" shiro:hasPermission="property:campusrecive:showIdle"> 查看闲置资产 </a>
			</div>
			<table class="table" id="addIdle">
				<tr>
					<th>资产编号</th>
					<th>资产名称</th>
					<th>品牌</th>
					<th>资产规格</th>
					<th>单位</th>
					<th>资产状态</th>
					<th>数量</th>
					<th>操作</th>
				</tr>
				<!--<tr>
					<td>
						<input type="text" name="assetNum" class="assetNum" required="required" placeholder="请输入资产编号" style="height: 30px;width: 80%;border: none;">
					</td>
					<td>
						<input type="text" name="name" class="name" required="required" placeholder="请输入资产名称" style="height: 30px;width: 80%;border: none;">
					</td>
					<td>
						<input type="text" name="brand" class="brand" required="required" placeholder="请输入品牌" style="height: 30px;width: 80%;border: none;">
					</td>
					<td>

						<input type="text" name="assetSpecification" class="assetSpecification" required="required" placeholder="请输入资产规格" style="height: 30px;width: 80%;border: none;">
					</td>
					<td>
						<select name="units" id="units" th:with="type=${@dict.getType('zc_unit')}" style="height: 30px;width: 60%;border: none;">
							<option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
						</select>
						&lt;!&ndash;<input type="text" name="units" class="units" required="required" placeholder="请输入单位" style="height: 30px;width: 80%;border: none;">&ndash;&gt;
					</td>
					<td>
						<select name="state" id="state" th:with="type=${@dict.getType('zc_state')}" style="height: 30px;width: 60%;border: none;">
							<option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
						</select>
						&lt;!&ndash;<input type="text" class="state" required="required" placeholder="请输入资产状态" style="height: 30px;width: 80%;border: none;">&ndash;&gt;
					</td>
					<td>
						<input type="text" name="number" class="number" required="required" placeholder="请输入数量" style="height: 30px;width: 80%;border: none;">
					</td>
					<td>
						<button type="button" class="btn btn-danger" onclick="del(this)">删除</button>
					</td>
				</tr>-->
			</table>
		</form>
	</div>
    <div th:include="include::footer"></div>
    <script type="text/javascript">
		var prefix = ctx + "property/campusrecive";

		function showIdle() {
			var state = 1;
			$.ajax({
				type:"POST",
				url:prefix + "/showIdle",
				data:{"state":state},
				dataType:"JSON",
				success:function (data) {
					console.log(data)
                },
				error:function (data) {
					window.alert("后台服务器异常！！！")
                }
			})

        }

        function del(data) {
			data.parentNode.parentNode.remove();
        }

        function add() {
            var trs="<tr>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"assetNum\" required=\"required\" placeholder=\"请输入资产编号\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"name\" required=\"required\" placeholder=\"请输入资产名称\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"brand\" required=\"required\" placeholder=\"请输入品牌\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"assetSpecification\" required=\"required\" placeholder=\"请输入资产规格\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"units\" required=\"required\" placeholder=\"请输入单位\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<select name=\"text\" class=\"status\" th:with=\"type=${@dict.getType('zc_state')}\"><option th:each=\"dict : ${type}\" th:text=\"${dict.dictLabel}\" th:value=\"${dict.dictValue}\"></option>></select>\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<input type=\"text\" class=\"number\" required=\"required\" placeholder=\"请输入数量\" style=\"height: 30px;width: 80%;border: none;\">\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t\t<td>\n" +
                "\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-danger\" onclick='del(this)'>删除</button>\n" +
                "\t\t\t\t\t</td>\n" +
                "\t\t\t\t</tr>";
            $("#addIdle").append(trs);
        }

        function submitHandler() {
            if ($.validate.form()) {
                addCampusrecive();
            }
        }
        function addCampusrecive() {
	        console.log("进入addCampusrecive()方法中");
            var campus = $("input[name='campus']").val();
            var department = $("input[name='department']").val();
            var extend2 = $("input[name='extend2']").val();
            var recipientsTime = $("input[name='recipientsTime']").val();
            var assetNum = $("input[name='assetNum']").val();
            var name = $("input[name='name']").val();
            var brand = $("input[name='brand']").val();
            var assetSpecification = $("input[name='assetSpecification']").val();
            var units = $("input[name='units']").val();
            var state = $("input[name='state']").val();
            var number = $("input[name='number']").val();

            /*var majors =[];
            var stageName = document.getElementsByClassName("stageName");
            var numberNo = document.getElementsByClassName("numberNo");
            console.log("majorName:" + majorName);
            console.log("majorType:" + majorType);
            for(var i = 0;i<stageName.length;i++){
                if(stageName[i].value != null && stageName[i].value != "" && stageName[i].value != "undefined"){
                    if(numberNo[i].value != null && numberNo[i].value != "" && numberNo[i].value != "undefined"){
                        var stage = stageName[i].value;
                        var no = numberNo[i].value;
                        majors.push({"stageName":stage,"sort":no});
					}
                }
			}
            var major = JSON.stringify(majors);
			console.log("major:" + major);*/
            $.ajax({
                cache : true,
                type : "POST",
                url : prefix + "/add",
                data : {
                    "campus": campus,
					"department":department,
					"extend2":extend2,
                    "recipientsTime": recipientsTime,
                    "assetNum":assetNum,
                    "name":name,
                    "brand": brand,
                    "assetSpecification":assetSpecification,
                    "units":units,
                    "state": state,
                    "number":number
                },
                async : false,
                error : function(request) {
                    $.modal.alertError("系统错误");
                },
                success : function(data) {
                    $.operate.successCallback(data);
                }
            })
        }
	</script>
</body>
</html>
